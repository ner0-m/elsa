FROM ubuntu:18.04
MAINTAINER Tobias Lasser <lasser@in.tum.de>
LABEL Description="default Ubuntu 18.04 with build essentials"

# install build tools, cmake, git, ninja
RUN apt-get -qq update; \
    DEBIAN_FRONTEND=noninteractive apt-get install -qqy \
       build-essential software-properties-common \
       cmake git pkg-config ninja-build wget

# install Intel MKL-DNN
ARG mkldnn_version=1.1.1
ARG mkldnn_folder=v${mkldnn_version}

RUN wget https://github.com/intel/mkl-dnn/archive/${mkldnn_folder}.tar.gz \
 && tar -xvzf ${mkldnn_folder}.tar.gz \
 && rm ${mkldnn_folder}.tar.gz \
 && cd mkl-dnn-${mkldnn_version} \
 && mkdir build && cd build \
 && cmake .. \
 && make -j28 && make install \
 && cd ../.. && rm -rf mkl-dnn-${mkldnn_version} && ldconfig

CMD bash
