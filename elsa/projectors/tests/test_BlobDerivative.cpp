#include "doctest/doctest.h"

#include "Blobs.h"
#include "spdlog/fmt/fmt.h"
#include <unordered_map>

using namespace elsa;
using namespace doctest;

TEST_SUITE_BEGIN("projectors");

constexpr index_t size = 101;

template <typename data_t>
constexpr std::array<double, size> getExpected(data_t a, data_t alphas, data_t ms);

TEST_CASE_TEMPLATE("Blobs: Test evaluation of projected blob derivative", data_t, float, double)
{
    constexpr std::array<data_t, 3> scales{100, 50, 30};
    constexpr std::array<data_t, 2> as{1, 2};
    constexpr std::array<data_t, 4> alphas{2.5, 5., 7.5, 10.83};
    constexpr std::array<index_t, 2> ms{1, 2};

    for (const auto a : as) {
        const auto scale = scales[static_cast<index_t>(a - 1)];
        for (const auto alpha : alphas) {
            for (const auto m : ms) {
                CAPTURE(scale);
                CAPTURE(a);
                CAPTURE(alpha);
                CAPTURE(m);

                auto expected = getExpected<data_t>(1, alpha, m);

                ProjectedBlob<data_t, size> blob(a, alpha, m);
                for (int i = 0; i < size; ++i) {
                    const auto x = i / scale;

                    CAPTURE(x);

                    CHECK_EQ(Approx(blob.template derivative<true>(x)), expected[i]);
                }
            }
        }
    }
}

/// These values here are computed using python, by evaluating the following python function:
/// Ref:
/// Investigation of discrete imaging models and iterative image reconstruction in differential
/// X-ray phase-contrast tomography - Qiaofeng Xu (Appendix B)
/// ```python
///    def blob_derivative_projected(s, a, alpha, m):
///     sda = s/a
///     sdas = sda**2
///     w = math.sqrt(1 - sdas)
///     Imalpha = iv(m,alpha)
///     Iwalpha = iv(m-0.5,alpha*w)
///     wroot = math.pow(w,m-0.5)
///     return - math.sqrt(2*math.pi*alpha) * sda * wroot * Iwalpha / Imalpha
/// ```
template <typename data_t>
constexpr std::array<double, size> getExpected(data_t a, data_t alpha, data_t m)
{
    if (a == 1) {
        if (alpha == 2.5) {
            if (m == 1) {
                // Blob evaulations with a = 1, alpha = 2.5 and m = 1, for values from 0 to 1.0
                return {-0.0,
                        -0.04807405669417535,
                        -0.09611157073815496,
                        -0.14407602627431668,
                        -0.19193096100651463,
                        -0.2396399929216377,
                        -0.28716684694015165,
                        -0.33447538147194333,
                        -0.38152961485378584,
                        -0.42829375164472916,
                        -0.47473220875571487,
                        -0.5208096413896902,
                        -0.5664909687684836,
                        -0.6117413996226595,
                        -0.6565264574205596,
                        -0.7008120053126505,
                        -0.7445642707672788,
                        -0.7877498698738223,
                        -0.8303358312891594,
                        -0.8722896198032404,
                        -0.9135791594994244,
                        -0.9541728564850634,
                        -0.9940396211676154,
                        -1.0331488900513377,
                        -1.071470647029303,
                        -1.1089754441451802,
                        -1.1456344217987895,
                        -1.1814193283690078,
                        -1.2163025392270497,
                        -1.2502570751125324,
                        -1.2832566198439892,
                        -1.315275537334685,
                        -1.3462888878835981,
                        -1.3762724437103127,
                        -1.4052027037012949,
                        -1.4330569073335366,
                        -1.4598130477398297,
                        -1.4854498838780155,
                        -1.5099469517642643,
                        -1.533284574727882,
                        -1.5554438726421873,
                        -1.5764067700825484,
                        -1.5961560033588256,
                        -1.6146751263648933,
                        -1.6319485151828044,
                        -1.6479613713731385,
                        -1.6626997238762438,
                        -1.676150429441121,
                        -1.688301171489543,
                        -1.6991404573123547,
                        -1.7086576134826073,
                        -1.7168427793558587,
                        -1.723686898511292,
                        -1.7291817079678848,
                        -1.7333197249870882,
                        -1.7360942312468244,
                        -1.7374992541402585,
                        -1.7375295449157813,
                        -1.736180553330982,
                        -1.7334483984414153,
                        -1.7293298350832413,
                        -1.7238222155349454,
                        -1.7169234457547784,
                        -1.7086319354838593,
                        -1.6989465413757934,
                        -1.6878665021568602,
                        -1.675391364629175,
                        -1.6615208990941923,
                        -1.6462550024837521,
                        -1.6295935871257068,
                        -1.6115364526214515,
                        -1.5920831377473172,
                        -1.571232748576346,
                        -1.5489837581046209,
                        -1.525333771493923,
                        -1.5002792495230353,
                        -1.4738151808528506,
                        -1.44593469108631,
                        -1.4166285731022619,
                        -1.3858847184157466,
                        -1.3536874228587878,
                        -1.3200165309319556,
                        -1.284846370609036,
                        -1.248144412431194,
                        -1.2098695606446148,
                        -1.1699699454792534,
                        -1.1283800271114788,
                        -1.0850167309636753,
                        -1.0397741889669891,
                        -0.992516422618059,
                        -0.9430668960088342,
                        -0.8911931412487312,
                        -0.8365833010253952,
                        -0.7788087380649978,
                        -0.717261109232539,
                        -0.651038854443691,
                        -0.5787226550702489,
                        -0.4978698225088995,
                        -0.4036254593620892,
                        -0.28324549831372686,
                        -0.0};
            } else if (m == 2) {
                // Blob evaulations with a = 1, alpha = 2.5 and m = 2, for values from 0 to 1.0
                return {-0.0,
                        -0.058151976312665624,
                        -0.1162328780220491,
                        -0.1741717205711958,
                        -0.23189769940337918,
                        -0.2893402797312516,
                        -0.34642928602913425,
                        -0.40309499115664704,
                        -0.4592682050223054,
                        -0.5148803626962262,
                        -0.5698636118817275,
                        -0.6241508996563326,
                        -0.6776760583935352,
                        -0.7303738907776194,
                        -0.7821802538249071,
                        -0.8330321418259148,
                        -0.882867768124222,
                        -0.9316266456491777,
                        -0.9792496661210799,
                        -1.0256791778490237,
                        -1.070859062043333,
                        -1.114734807566266,
                        -1.1572535840466232,
                        -1.1983643132858957,
                        -1.2380177388857248,
                        -1.2761664940287272,
                        -1.3127651673470648,
                        -1.3477703668156729,
                        -1.3811407816096424,
                        -1.4128372418680206,
                        -1.442822776309121,
                        -1.4710626676455085,
                        -1.4975245057499011,
                        -1.522178238526585,
                        -1.5449962204463592,
                        -1.5659532587066571,
                        -1.5850266569822982,
                        -1.6021962567362662,
                        -1.6174444760641575,
                        -1.6307563460502783,
                        -1.6421195446180668,
                        -1.6515244278623749,
                        -1.65896405885635,
                        -1.6644342339311602,
                        -1.6679335064326248,
                        -1.669463207965089,
                        -1.6690274671395164,
                        -1.666633225849943,
                        -1.6622902531101917,
                        -1.656011156491004,
                        -1.6478113912068921,
                        -1.637709266911829,
                        -1.6257259522737322,
                        -1.6118854774095943,
                        -1.596214734276256,
                        -1.5787434751263987,
                        -1.5595043091556684,
                        -1.5385326974850821,
                        -1.515866946643465,
                        -1.4915482007380236,
                        -1.4656204325277207,
                        -1.4381304336445375,
                        -1.4091278042427424,
                        -1.37866494239675,
                        -1.3467970336153543,
                        -1.3135820408951175,
                        -1.2790806958006447,
                        -1.2433564911360266,
                        -1.2064756758629946,
                        -1.1685072530304697,
                        -1.1295229816115775,
                        -1.0895973833035024,
                        -1.048807755539759,
                        -1.0072341922030916,
                        -0.9649596138224134,
                        -0.9220698094052853,
                        -0.8786534925200584,
                        -0.834802374828399,
                        -0.7906112610196104,
                        -0.7461781700683584,
                        -0.7016044890049901,
                        -0.6569951670629964,
                        -0.6124589603108012,
                        -0.5681087399189,
                        -0.5240618814081323,
                        -0.4804407581039403,
                        -0.4373733704172193,
                        -0.39499415481628714,
                        -0.35344503463861615,
                        -0.31287680294031595,
                        -0.27345097196361634,
                        -0.2353422965966166,
                        -0.19874230374778465,
                        -0.16386438369761855,
                        -0.13095142847966623,
                        -0.10028788910515746,
                        -0.07222014823654624,
                        -0.047194395748366216,
                        -0.025838028396018092,
                        -0.009185149750792604,
                        -0.0};
            }
        } else if (alpha == 5.0) {
            if (m == 1) {
                // Blob evaulations with a = 1, alpha = 5 and m = 1, for values from 0 to 1.0
                return {-0.0,
                        -0.06096790831435612,
                        -0.12184437931741952,
                        -0.18253815850449168,
                        -0.24295835656819004,
                        -0.3030146309584343,
                        -0.3626173661988426,
                        -0.4216778525496929,
                        -0.48010846261161183,
                        -0.5378228254691266,
                        -0.5947359979791815,
                        -0.6507646328166162,
                        -0.7058271428964454,
                        -0.7598438618015483,
                        -0.8127371998540317,
                        -0.8644317954790264,
                        -0.9148546615210973,
                        -0.9639353261855772,
                        -1.0116059682901435,
                        -1.0578015465256445,
                        -1.1024599224396492,
                        -1.1455219768712817,
                        -1.1869317195816806,
                        -1.2266363918407948,
                        -1.2645865617480867,
                        -1.300736212082269,
                        -1.3350428204929832,
                        -1.3674674318657796,
                        -1.39797472271041,
                        -1.4265330574415525,
                        -1.453114536440374,
                        -1.4776950358049836,
                        -1.5002542387175255,
                        -1.5207756583756054,
                        -1.5392466524556816,
                        -1.5556584290961206,
                        -1.570006044407514,
                        -1.582288391537871,
                        -1.5925081813399824,
                        -1.6006719147079176,
                        -1.6067898466689672,
                        -1.610875942336377,
                        -1.6129478248470133,
                        -1.6130267154263658,
                        -1.6111373657412094,
                        -1.6073079827175654,
                        -1.6015701460184648,
                        -1.5939587183920816,
                        -1.5845117491163903,
                        -1.5732703707811346,
                        -1.5602786896618868,
                        -1.5455836699539478,
                        -1.5292350121459382,
                        -1.5112850258239534,
                        -1.491788497207062,
                        -1.4708025517235637,
                        -1.4483865119447796,
                        -1.4246017511989413,
                        -1.3995115431919796,
                        -1.373180907964323,
                        -1.3456764545131374,
                        -1.3170662204073935,
                        -1.2874195087183506,
                        -1.2568067225801987,
                        -1.2252991976839938,
                        -1.1929690329920124,
                        -1.1598889199383702,
                        -1.126131970353892,
                        -1.091771543317406,
                        -1.056881071089628,
                        -1.0215338842270827,
                        -0.9858030358983793,
                        -0.9497611253286321,
                        -0.9134801201734538,
                        -0.8770311774623835,
                        -0.8404844625401815,
                        -0.8039089651553144,
                        -0.7673723114725965,
                        -0.7309405702849278,
                        -0.694678051013885,
                        -0.6586470901417438,
                        -0.6229078213895192,
                        -0.5875179230652792,
                        -0.5525323332712235,
                        -0.5180029196262311,
                        -0.4839780840992146,
                        -0.4505022742321992,
                        -0.4176153573546913,
                        -0.3853517906163295,
                        -0.3537394799190827,
                        -0.3227981519318874,
                        -0.29253693880048004,
                        -0.262950638485734,
                        -0.23401363645206702,
                        -0.20566943971699614,
                        -0.17781131639713244,
                        -0.1502429589235722,
                        -0.12258739023785722,
                        -0.09402928486974793,
                        -0.06226588848255436,
                        -0.0};
            } else if (m == 2) {
                // Blob evaulations with a = 1, alpha = 5 and m = 2, for values from 0 to 1.0
                return {-0.0,
                        -0.06780768117960852,
                        -0.13548827711973616,
                        -0.20291502022494148,
                        -0.2699617772988131,
                        -0.336503364523465,
                        -0.4024158597822807,
                        -0.4675769114524211,
                        -0.5318660428039375,
                        -0.5951649511551781,
                        -0.6573578009495088,
                        -0.7183315099361487,
                        -0.7779760276580748,
                        -0.8361846054724478,
                        -0.8928540573537695,
                        -0.9478850107568905,
                        -1.0011821468460915,
                        -1.0526544294274727,
                        -1.1022153219549384,
                        -1.149782992014864,
                        -1.1952805027311246,
                        -1.2386359905703432,
                        -1.2797828290669018,
                        -1.3186597780283935,
                        -1.3552111178244786,
                        -1.3893867684057066,
                        -1.4211423927433124,
                        -1.450439484426457,
                        -1.4772454391995082,
                        -1.5015336102687844,
                        -1.5232833472553597,
                        -1.5424800187182375,
                        -1.5591150182198783,
                        -1.5731857539540095,
                        -1.5846956220033646,
                        -1.5936539633425848,
                        -1.6000760047486715,
                        -1.603982783828106,
                        -1.6054010584157734,
                        -1.6043632006461421,
                        -1.600907076041546,
                        -1.5950759080057269,
                        -1.5869181281530806,
                        -1.5764872129449328,
                        -1.563841507143734,
                        -1.5490440346341214,
                        -1.5321622971962698,
                        -1.5132680618516168,
                        -1.4924371374341256,
                        -1.4697491410711843,
                        -1.4452872552874492,
                        -1.4191379764719905,
                        -1.3913908554740595,
                        -1.3621382311157162,
                        -1.3314749574301852,
                        -1.2994981254532727,
                        -1.2663067804114772,
                        -1.232001635164393,
                        -1.1966847807708674,
                        -1.160459395058042,
                        -1.1234294500799022,
                        -1.0856994193575618,
                        -1.0473739857970485,
                        -1.0085577511822712,
                        -0.9693549481410969,
                        -0.9298691554814814,
                        -0.8902030177925294,
                        -0.8504579702027925,
                        -0.8107339691853905,
                        -0.7711292302974146,
                        -0.7317399737403671,
                        -0.6926601786301624,
                        -0.6539813468708464,
                        -0.6157922775375951,
                        -0.5781788526940611,
                        -0.5412238356000356,
                        -0.5050066823120596,
                        -0.4696033677479527,
                        -0.43508622738455155,
                        -0.40152381589765296,
                        -0.36898078425068154,
                        -0.33751777701733693,
                        -0.3071913521177943,
                        -0.2780539257089847,
                        -0.25015374577439475,
                        -0.22353489912735394,
                        -0.1982373582632427,
                        -0.17429707707756015,
                        -0.15174614842124765,
                        -0.1306130426760709,
                        -0.11092295658224333,
                        -0.0926983183873736,
                        -0.07595952479237222,
                        -0.06072603916725868,
                        -0.04701808593238235,
                        -0.03485939827254995,
                        -0.024281994048674854,
                        -0.015335335014670217,
                        -0.008106708104619532,
                        -0.0027799757213245483,
                        -0.0};
            }
        } else if (alpha == 7.5) {
            if (m == 1) {
                // Blob evaulations with a = 1, alpha = 7.5 and m = 1, for values from 0 to 1.0
                return {-0.0,
                        -0.07241495084698643,
                        -0.14466703922253218,
                        -0.2165939316897052,
                        -0.2880343507879577,
                        -0.35882859779904375,
                        -0.4288190692722565,
                        -0.49785076527200856,
                        -0.5657717873476202,
                        -0.6324338242708478,
                        -0.6976926236410406,
                        -0.7614084475205377,
                        -0.8234465103337589,
                        -0.8836773973419927,
                        -0.9419774620918768,
                        -0.9982292013284546,
                        -1.052321605963155,
                        -1.1041504867925311,
                        -1.1536187737746233,
                        -1.200636787785865,
                        -1.245122483901989,
                        -1.287001665370778,
                        -1.3262081675722321,
                        -1.362684011392151,
                        -1.3963795255676226,
                        -1.4272534376968664,
                        -1.455272933740707,
                        -1.4804136859779102,
                        -1.5026598495112224,
                        -1.5220040275544442,
                        -1.5384472058626921,
                        -1.55199865679763,
                        -1.56267581364601,
                        -1.5705041159332018,
                        -1.5755168265924697,
                        -1.5777548219654995,
                        -1.5772663557191389,
                        -1.574106797867371,
                        -1.5683383501855024,
                        -1.5600297393950497,
                        -1.5492558895824886,
                        -1.5360975753925095,
                        -1.5206410576063538,
                        -1.5029777027779179,
                        -1.4832035886543646,
                        -1.4614190971538208,
                        -1.4377284967100181,
                        -1.4122395158226402,
                        -1.3850629096722156,
                        -1.3563120216699673,
                        -1.3261023418158076,
                        -1.2945510637319317,
                        -1.2617766422250642,
                        -1.2278983532077519,
                        -1.1930358577780853,
                        -1.1573087722182203,
                        -1.1208362456253007,
                        -1.0837365468340898,
                        -1.0461266622290433,
                        -1.0081219059753013,
                        -0.9698355441231151,
                        -0.9313784339593727,
                        -0.8928586798931916,
                        -0.8543813070707299,
                        -0.8160479538176909,
                        -0.7779565839069803,
                        -0.7402012195440995,
                        -0.7028716958545148,
                        -0.6660534375459036,
                        -0.6298272583041974,
                        -0.5942691833661163,
                        -0.5594502955926605,
                        -0.5254366052479041,
                        -0.49228894356557085,
                        -0.4600628800618465,
                        -0.4288086634263202,
                        -0.3985711856926835,
                        -0.36938996925518025,
                        -0.3412991761529581,
                        -0.3143276388879587,
                        -0.28849891186590054,
                        -0.26383134234333566,
                        -0.24033815950945578,
                        -0.21802758000172284,
                        -0.19690292770447096,
                        -0.17696276503452257,
                        -0.15820103195005367,
                        -0.14060718740482167,
                        -0.12416634550538615,
                        -0.10885939445637816,
                        -0.09466307901782807,
                        -0.08155001361394922,
                        -0.06948856684135377,
                        -0.058442503655584024,
                        -0.04837015053510147,
                        -0.039222554360971905,
                        -0.030939297547201764,
                        -0.02343801989008018,
                        -0.0165829220056439,
                        -0.010049253935595227,
                        -0.0};
            } else if (m == 2) {
                // Blob evaulations with a = 1, alpha = 7.5 and m = 2, for values from 0 to 1.0
                return {-0.0,
                        -0.07769098464274034,
                        -0.15518037347234012,
                        -0.23226732622269844,
                        -0.30875251028613243,
                        -0.3844388459708989,
                        -0.45913224152152693,
                        -0.5326423145706437,
                        -0.604783096759932,
                        -0.6753737183533233,
                        -0.7442390697670577,
                        -0.8112104370582878,
                        -0.8761261085458513,
                        -0.9388319498828767,
                        -0.9991819450603868,
                        -1.0570387009929998,
                        -1.1122739135213628,
                        -1.164768792860085,
                        -1.2144144467235525,
                        -1.2611122195741247,
                        -1.3047739866565742,
                        -1.3453224017080985,
                        -1.3826910974636333,
                        -1.4168248383102628,
                        -1.4476796246809382,
                        -1.4752227490153702,
                        -1.4994328033534403,
                        -1.5202996388626002,
                        -1.5378242778342293,
                        -1.552018778913541,
                        -1.562906056552209,
                        -1.570519655891258,
                        -1.5749034844926193,
                        -1.5761115025403563,
                        -1.574207373325422,
                        -1.569264076010401,
                        -1.5613634828416036,
                        -1.5505959031347731,
                        -1.5370595965062808,
                        -1.5208602579536301,
                        -1.502110477506581,
                        -1.480929177272751,
                        -1.457441028788659,
                        -1.431775853658453,
                        -1.4040680105177585,
                        -1.3744557713990448,
                        -1.3430806905973072,
                        -1.3100869691410442,
                        -1.275620817963179,
                        -1.2398298228401676,
                        -1.2028623141251698,
                        -1.1648667442432459,
                        -1.1259910758434086,
                        -1.086382183414702,
                        -1.0461852710716781,
                        -1.0055433090994563,
                        -0.9645964917208084,
                        -0.9234817184080505,
                        -0.8823321009118432,
                        -0.8412764980184207,
                        -0.8004390798769224,
                        -0.7599389235607502,
                        -0.7198896413420146,
                        -0.6803990429674528,
                        -0.6415688330287239,
                        -0.6034943443208579,
                        -0.5662643078811233,
                        -0.5299606601977286,
                        -0.49465838787492955,
                        -0.46042540983931435,
                        -0.42732249697264685,
                        -0.39540322886077445,
                        -0.36471398715695463,
                        -0.3352939848728696,
                        -0.3071753307326837,
                        -0.28038312755618355,
                        -0.25493560347762106,
                        -0.23084427465891738,
                        -0.2081141380210743,
                        -0.18674389239801786,
                        -0.16672618641526565,
                        -0.14804789131513288,
                        -0.1306903968953521,
                        -0.11462992870580156,
                        -0.0998378846686358,
                        -0.08628118936628222,
                        -0.07392266440475362,
                        -0.06272141354807492,
                        -0.052633221804167934,
                        -0.043610968447785094,
                        -0.035605055319589164,
                        -0.02856385407611022,
                        -0.022434180252563902,
                        -0.017161809887783548,
                        -0.012692070267750337,
                        -0.008970570597231688,
                        -0.005944220514474687,
                        -0.0035629099795605724,
                        -0.001782980842507198,
                        -0.0005771716363401995,
                        -0.0};
            }
        } else if (alpha == Approx(10.83)) {
            if (m == 1) {
                // Blob evaulations with a = 1, alpha = 10.83 and m = 0, for values from 0 to 1.0
                return {-0.0,
                        -0.08549984026761001,
                        -0.17072208239140316,
                        -0.25539049145599496,
                        -0.33923155048790277,
                        -0.4219757982013247,
                        -0.5033591414475242,
                        -0.5831241342238286,
                        -0.6610212153422091,
                        -0.7368098971586319,
                        -0.8102598981203354,
                        -0.8811522122961025,
                        -0.9492801095110626,
                        -1.0144500602089472,
                        -1.076482579706935,
                        -1.1352129870869088,
                        -1.190492074577474,
                        -1.2421866839184907,
                        -1.2901801868591984,
                        -1.3343728676167999,
                        -1.3746822058095702,
                        -1.411043059071377,
                        -1.4434077452478782,
                        -1.4717460247629617,
                        -1.496044984421918,
                        -1.5163088245803076,
                        -1.5325585522493126,
                        -1.5448315833248183,
                        -1.553181257713913,
                        -1.5576762716846946,
                        -1.558400032279075,
                        -1.5554499391004266,
                        -1.5489365992145896,
                        -1.5389829812817357,
                        -1.5257235153649427,
                        -1.509303145137451,
                        -1.4898763394325802,
                        -1.4676060702474918,
                        -1.4426627644235277,
                        -1.4152232362815986,
                        -1.3854696084916887,
                        -1.353588228401295,
                        -1.3197685869402513,
                        -1.284202247060166,
                        -1.2470817884579766,
                        -1.2085997750772282,
                        -1.1689477515803985,
                        -1.1283152746441918,
                        -1.086888984550545,
                        -1.0448517221328584,
                        -1.0023816956936944,
                        -0.9596517020408879,
                        -0.9168284052980535,
                        -0.8740716766372262,
                        -0.8315339975602657,
                        -0.7893599288261924,
                        -0.7476856465883376,
                        -0.7066385467724514,
                        -0.6663369181990599,
                        -0.6268896844347566,
                        -0.5883962138515453,
                        -0.5509461968850489,
                        -0.5146195890146231,
                        -0.4794866175449323,
                        -0.4456078498521187,
                        -0.41303432037142646,
                        -0.3818077132493505,
                        -0.3519605972642322,
                        -0.323516709336635,
                        -0.2964912827060825,
                        -0.27089141564501173,
                        -0.24671647641479558,
                        -0.22395854004263124,
                        -0.20260285241212733,
                        -0.1826283171139817,
                        -0.16400800049561198,
                        -0.14670965037880496,
                        -0.13069622398103703,
                        -0.11592642067729776,
                        -0.10235521537298914,
                        -0.08993438842239877,
                        -0.07861304821863029,
                        -0.06833814279661843,
                        -0.05905495702738001,
                        -0.05070759223463777,
                        -0.04323942532902969,
                        -0.03659354482299295,
                        -0.030713161350365423,
                        -0.02554199055147808,
                        -0.02102460636642979,
                        -0.017106762847846277,
                        -0.013735682439226739,
                        -0.010860307999472126,
                        -0.008431514052664273,
                        -0.006402268152025606,
                        -0.004727721099914972,
                        -0.0033651693463591843,
                        -0.0022737121974922593,
                        -0.0014129017679336262,
                        -0.0007361597600503701,
                        -0.0};
            } else if (m == 2) {
                // Blob evaulations with a = 1, alpha = 10.83 and m = 1, for values from 0 to 1.0
                return {-0.0,
                        -0.08970870892840589,
                        -0.17909654687881035,
                        -0.26784437875727957,
                        -0.35563652930600537,
                        -0.4421624832871329,
                        -0.5271185502529296,
                        -0.6102094825408508,
                        -0.6911500355067857,
                        -0.7696664594718747,
                        -0.8454979134036369,
                        -0.9183977909758657,
                        -0.9881349503484358,
                        -1.0544948397713847,
                        -1.1172805119409395,
                        -1.1763135209110158,
                        -1.2314346962846365,
                        -1.2825047903674207,
                        -1.3294049949516629,
                        -1.372037325405639,
                        -1.4103248707603944,
                        -1.444211909506026,
                        -1.4736638918232672,
                        -1.4986672899749498,
                        -1.5192293195573565,
                        -1.5353775352556074,
                        -1.5471593056519102,
                        -1.5546411724936946,
                        -1.5579081006331938,
                        -1.557062625594656,
                        -1.5522239064042773,
                        -1.5435266919261814,
                        -1.5311202094804435,
                        -1.5151669849732547,
                        -1.495841604141175,
                        -1.4733294247995286,
                        -1.4478252501872437,
                        -1.419531973617019,
                        -1.3886592046701633,
                        -1.3554218871210428,
                        -1.3200389186386585,
                        -1.2827317820945643,
                        -1.243723198010711,
                        -1.2032358073113427,
                        -1.1614908931045327,
                        -1.118707149716182,
                        -1.0750995066379099,
                        -1.030878014436251,
                        -0.9862467990103835,
                        -0.9414030898858058,
                        -0.8965363274991592,
                        -0.8518273536716898,
                        -0.8074476886930679,
                        -0.7635588976507305,
                        -0.7203120478497846,
                        -0.6778472583820527,
                        -0.6362933421270739,
                        -0.5957675397095211,
                        -0.5563753442030087,
                        -0.5182104146659609,
                        -0.4813545759264531,
                        -0.445877901405388,
                        -0.41183887518544293,
                        -0.3792846290013888,
                        -0.348251249349081,
                        -0.3187641494889199,
                        -0.2908385007571138,
                        -0.26447971729660674,
                        -0.2396839880801905,
                        -0.21643884992163567,
                        -0.19472379505661072,
                        -0.17451090682304785,
                        -0.15576551697911548,
                        -0.13844687826434998,
                        -0.12250884593330752,
                        -0.10790056216855802,
                        -0.09456713750756723,
                        -0.08245032369235135,
                        -0.07148917266760471,
                        -0.06162067680795976,
                        -0.05278038584350806,
                        -0.044902996369897634,
                        -0.0379229102703325,
                        -0.03177475883674966,
                        -0.026393889851509665,
                        -0.02171681537458387,
                        -0.017681618470379065,
                        -0.014228317599792588,
                        -0.011299187895158045,
                        -0.008839039029507416,
                        -0.0067954498934794565,
                        -0.005118960820510834,
                        -0.0037632246942695476,
                        -0.002685119026170983,
                        -0.0018448222347190884,
                        -0.001205859493358183,
                        -0.0007351283953634148,
                        -0.00040292828426683115,
                        -0.00018306476980228695,
                        -5.333866529830615e-05,
                        -0.0};
            }
        }
    }
    return {0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
            0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
            0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
            0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
            0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
            0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0};
}
TEST_SUITE_END();
